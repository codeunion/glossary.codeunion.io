---
further-reading:
  - callback
---
Programs can send and receive messages to each other. One way to work with this functionality is to implement the notion of **events**. With events, you can write code that says "when this happens, run this function".

The larger paradigm of writing code that sends and receives events is called [event-driven programming](http://en.wikipedia.org/wiki/Event-driven_programming), and is closely related to other [messaging patterns](http://en.wikipedia.org/wiki/Messaging_pattern) like the [publish-subscribe](http://en.wikipedia.org/wiki/Publish%E2%80%93subscribe_pattern) pattern.

In this article, we will cover the concept of events using the language of **subscribing** and **publishing**, which can be thought of as roughly equivalent to _event handlers_ and _event firing_, respectively.

_Why would you want to use an evented model?_

Say you have one program that manages news stories, and another program that reads these bulletins. When a new story comes in, you want the reading program to be notified immediately.

In other words, you want one program to _publish_ stories, and the other program to _subscribe_ to the first. That way, you can satisfy the use case of "when a new story is published, it should appear on the news reader".

Here is a simple implementation of this kind of behavior as a Ruby script:

```ruby
$subscriptions = [] # a store for subscriptions

# create a new subscription for a certain of event
def subscribe(event_name, &callback)
  $subscriptions.push({ :event => event_name, :callback => callback })
end

# distribute event data to all subscriptions for
# the given kind of event
def publish(event_name, event_data = "")
  $subscriptions.each do |subscription|
    if subscription[:event] == event_name
      subscription[:callback].call(event_data)
    end
  end
end

publish(:news)
# Huh, doesn't do much

subscribe(:news) { puts "New story received." }

publish(:news, "President declares national holiday")
# => New story received

subscribe(:news) do |story|
  puts "This just in: #{story}"
end

publish(:news, "Gophers are psychic!")
# => New story received.
# => This just in: Gophers are psychic!

publish(:gossip, "Pope dances tango with Richard Dawkins")
# Hmm, nobody seems to be listening
```
